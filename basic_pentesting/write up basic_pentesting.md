<p> Fizemos o reconhecimento da rede utilizando o: <b> nmap -sC -sV ip </b> 
O -sV investiga todas as portas abertas que encontra para determinar se podemos obter as informações de serviço/versão. 
O sinalizador -sC também executa scripts em portas abertas para determinar se há vulnerabilidades externas/comuns que podemos usar imediatamente
</p>
<img src="https://raw.githubusercontent.com/LuaFly/tryhackme/main/basic_pentesting/images/Captura%20de%20tela%20de%202023-03-29%2020-26-08.png" alt="retorno do nmap"/>

<p> Como tem a porta 80 aberta, sabemos que há um site, então fizemos um <b>dirb http://ip </b>, para enumerar os diretórios existentes: </p>
<img src="https://raw.githubusercontent.com/LuaFly/tryhackme/main/basic_pentesting/images/Captura%20de%20tela%20de%202023-03-29%2020-29-30.png" alt="retorno do dirb" />

<p>Encontramos 3 diretórios, ao analisá-los descobrimos que o development havia informações que nitidamente não deveriam estar ali: </p>
<img src="https://raw.githubusercontent.com/LuaFly/tryhackme/main/basic_pentesting/images/Captura%20de%20tela%20de%202023-03-29%2020-30-48.png" alt="arquivos do diretório development" />

<p> Havia troca de mensagens entre o -J e o -K </p>
<img src="https://raw.githubusercontent.com/LuaFly/tryhackme/main/basic_pentesting/images/Captura%20de%20tela%20de%202023-03-29%2020-31-02.png" alt="troca de mensagens 1"/>
<img src="https://raw.githubusercontent.com/LuaFly/tryhackme/main/basic_pentesting/images/Captura%20de%20tela%20de%202023-03-29%2020-32-02.png" alt="troca de mensagens 2"/>

<p> Como não havia nenhum usuário ou senha, resolvemos fazer uma enumeração de usuários no smb utilizando o <b> enum4linux ip </b>(é uma ferramenta para enumerar usuário windows e do smb/samba), e com isso tivemos o retorno de 2 usuários, o Jay e o Kay. </p> 
<img src="https://raw.githubusercontent.com/LuaFly/tryhackme/main/basic_pentesting/images/Captura%20de%20tela%20de%202023-03-29%2020-36-35.png" alt="usuários encontrados"/>
<p> Também testamos o usuário anonymous do smb:<b> smbclient //ip/anonymous </b> para testarmos se conseguimos acessar com o usuário anonymous e sem senha.  E deu certo:</p>
<img src="https://raw.githubusercontent.com/LuaFly/tryhackme/main/basic_pentesting/images/Captura%20de%20tela%20de%202023-03-29%2020-38-34.png"/>
<p> baixamos o arquivo staff.txt com o comando <b> get staff.txt </b>
E ao abrirmos o arquivo (para abrir o arquivo, você terá que sair do smb com o comando exit, e dará um ls na sua máquina normal, lá irá aparecer algumas pastas como Desktop, Download, e também terá o arquivo baixado staff.txt, para abrir é só dar <b> nano staff.txt </b>) vimos outra troca de mensagem: </p>

<img src="https://raw.githubusercontent.com/LuaFly/tryhackme/main/basic_pentesting/images/Captura%20de%20tela%20de%202023-03-29%2020-39-45.png" />

<p> Ao ler as mensagens, é possível verificar que o Jan não segue as políticas de senha, ou seja, a senha dele provavelmente é fraca, com isso iremos tentar fazer uma conexão ssh, mas antes temos que descobrir a senha do Jan, iremos utilizar o seguinte comando: <b> hydra -l jan -P /usr/share/wordlists/rockyou.txt ip ssh </b> (hydra é  usada para força bruta de nomes de usuário e senhas para diferentes serviços, como FTP, ssh, telnet, MS SQL, etc. A força bruta pode ser usada para tentar diferentes nomes de usuário e senhas contra um alvo para identificar as credenciais corretas.), como já sabemos o nome do usuário, colocamos apenas uma lista de senhas para a ferramenta, no caso a lista rockyou. E descobrimos a senha: </p>
<img src="https://raw.githubusercontent.com/LuaFly/tryhackme/main/basic_pentesting/images/Captura%20de%20tela%20de%202023-03-29%2020-48-41.png" alt="retorno da senha do jan pelo hydra" />

<p> Agora para acessar o ssh, usamos o comando:<b> ssh jan@ip, yes,</b> e colocamos a senha, e conseguimos logar: </p>
<img src="https://raw.githubusercontent.com/LuaFly/tryhackme/main/basic_pentesting/images/Captura%20de%20tela%20de%202023-03-29%2020-50-33.png"/>

<p> Ao dar o /home, utilizando o comando ls -la, verificamos que havia uma pasta chamanda kay, e sela outra pasta chamada .ssh (para chegar nela é preciso digitar: <b> cd /home/kay/.ssh </b>), e vimos que havia as chaves de conexão automática do ssh (id_rsa) Copei ela do —---- Begin, até o final do arquivo (para abrir o arquivo dei um <b>cat id_rsa</b>) </p>
<img src="https://raw.githubusercontent.com/LuaFly/tryhackme/main/basic_pentesting/images/Captura%20de%20tela%20de%202023-03-29%2020-53-37.png" />
<img src="https://github.com/LuaFly/tryhackme/blob/main/basic_pentesting/images/Captura%20de%20tela%20de%202023-03-29%2020-53-21.png" />

<p> Sai do Jay e voltei para a minha máquina normal, onde criei o arquivo id_rsa </p>
<img src="https://raw.githubusercontent.com/LuaFly/tryhackme/main/basic_pentesting/images/Captura%20de%20tela%20de%202023-03-29%2020-55-02.png" />

<p> Para decriptar a chave, transformei ela em um arquivo hash que a ferramenta john consiga decifrar, utilizando o seguinte comando: <b> python /opt/john/ssh2john.py id_rsa > hash.txt </b>,
Com isso utilizando o comando: <b> john  –wordlist=”/usr/share/wordlists/rockyou.txt </b>” para ele tentar decifrar ( no caso, tem a lista rockyou, onde há milhares de senha possíveis que já foram vazadas, ele faz uma comparação de hash, se a hash for igual a hash de alguma senha da lista ele consegue mostrar pra gente qual a senha). Como vemos abaixo descobrimos a senha beeswax </p>
<img src="https://raw.githubusercontent.com/LuaFly/tryhackme/main/basic_pentesting/images/Captura%20de%20tela%20de%202023-03-29%2021-02-12.png" />

<p> Após isso nos conectamos no jay novamente, e fizemos a conexão ssh do usuário kay: </p>
<img src="https://raw.githubusercontent.com/LuaFly/tryhackme/main/basic_pentesting/images/Captura%20de%20tela%20de%202023-03-29%2021-03-39.png" />

<p> Utilizando o comando: ssh -i id_rsa kay@ip, yes, colocamos a senha beeswax, e conseguimos visualizar o arquivo escondido:</p>
<img src="https://raw.githubusercontent.com/LuaFly/tryhackme/main/basic_pentesting/images/Captura%20de%20tela%20de%202023-03-29%2021-06-08.png"/>
